<!DOCTYPE html>
<html>
<head>
    <title>Investigation Knowledge Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .graph-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        #hierarchy-chart {
            width: 100%;
            height: 800px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
        }
        
        .node {
            cursor: pointer;
        }
        
        .node circle {
            stroke: #fff;
            stroke-width: 2px;
        }
        
        .node text {
            font: 12px sans-serif;
            pointer-events: none;
        }
        
        .link {
            fill: none;
            stroke: #999;
            stroke-width: 2px;
            stroke-opacity: 0.6;
        }
        
        .tooltip {
            position: absolute;
            padding: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 4px;
            font-size: 12px;
            max-width: 300px;
            pointer-events: none;
            z-index: 1000;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #f5f5f5;
            border-radius: 20px;
        }
        .color-box {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        .stats-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .stats-panel h3 {
            margin-top: 0;
            color: #333;
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }
        .stat-value {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .dead-ends {
            margin-top: 15px;
            padding: 10px;
            background: #fff3cd;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }
        .dead-ends h4 {
            margin: 0 0 8px 0;
            color: #856404;
        }
        .dead-end-list {
            margin: 0;
            padding-left: 20px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Investigation Knowledge Graph</h1>
        
        <div class="graph-container">
            <div class="legend">
                <div class="legend-item">
                    <span class="color-box" style="background: #9C27B0;"></span>
                    <span>Initial Query</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #4CAF50;"></span>
                    <span>Search Queries</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #2196F3;"></span>
                    <span>Findings (DataPoints)</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #FF9800;"></span>
                    <span>Insights (Patterns)</span>
                </div>
            </div>
            
            <svg id="hierarchy-chart"></svg>
        </div>
        
        
    <div class="stats-panel">
        <h3>Investigation Statistics</h3>
        <div class="stat-grid">
            <div class="stat-item">
                <span class="stat-label">Total Nodes:</span>
                <span class="stat-value">23</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Searches:</span>
                <span class="stat-value">12</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Findings:</span>
                <span class="stat-value">10</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Insights:</span>
                <span class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Connections:</span>
                <span class="stat-value">22</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Graph Density:</span>
                <span class="stat-value">0.043</span>
            </div>
        </div>
        
        <div class="dead-ends">
            <h4>Dead-end Searches (no significant findings):</h4>
            <ul class="dead-end-list">
                <li>Search #2025-09-08T01:00:26.635523: 0</li>
<li>Timeline #2025-09-08T01:00:26.635523: @GretaThunberg</li>
<li>Timeline #2025-09-08T01:00:26.635523: @tedcruz</li>
<li>Timeline #2025-09-08T01:00:26.635523: @unfccc</li>
<li>Timeline #2025-09-08T01:00:26.635523: @AOC</li>
            </ul>
        </div>
    </div>
    </div>

    <script>
        // Hierarchy data from Python
        const hierarchyData = {
  "name": "Query: What are different perspective...",
  "type": "query",
  "id": "5c59cad10cd8",
  "content": "What are different perspectives on climate change policies",
  "timestamp": "2025-09-08T01:00:02.046713",
  "metadata": {
    "original_query": "What are different perspectives on climate change policies"
  },
  "children": [
    {
      "name": "Search #2025-09-08T01:00:26.634523: Strategic question: A bro...",
      "type": "search",
      "id": "62a7cd118d98",
      "content": "0 with params: {\"query\": \"Strategic question: A broad topical search (Latest) will surface current public conversation and examples of how people argue for or against specific policy instruments and terms. This captures a diversity of perspectives in real time and finds candidate tweets to analyze framing, hashtags, and common rebuttals.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.836338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: A broad topical search (Latest) will surface current public conversation and examples of how people argue for or against specific policy instruments and terms. This captures a diversity of perspectives in real time and finds candidate tweets to analyze framing, hashtags, and common rebuttals.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.634523"
      },
      "children": [
        {
          "name": "Search #2025-09-08T01:00:26.634523: climate policy (\"carbon t...",
          "type": "search",
          "id": "8315e59f7241",
          "content": "0 with params: {\"endpoint\": \"search.php\", \"query\": \"climate policy (\\\"carbon tax\\\" OR \\\"cap and trade\\\" OR \\\"Green New Deal\\\" OR \\\"net zero\\\" OR adaptation OR \\\"climate finance\\\" OR \\\"climate action\\\")\", \"search_type\": \"Latest\"}",
          "timestamp": "2025-09-08T01:02:42.836338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "search.php",
              "query": "climate policy (\"carbon tax\" OR \"cap and trade\" OR \"Green New Deal\" OR \"net zero\" OR adaptation OR \"climate finance\" OR \"climate action\")",
              "search_type": "Latest"
            },
            "search_num": "2025-09-08T01:00:26.634523"
          },
          "children": [
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "6b0d329c562c",
              "content": "Climate change policy climate_debate discussion 0: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "f44be60396db",
              "content": "Climate change policy climate_debate discussion 1: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "f51c6be40084",
              "content": "Climate change policy climate_debate discussion 2: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "982f108b9ff7",
              "content": "Climate change policy climate_debate discussion 3: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "66ffd52c5e57",
              "content": "Climate change policy climate_debate discussion 4: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "5b35bbfa461f",
              "content": "Climate change policy climate_debate discussion 5: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "d5f0a8a2716c",
              "content": "Climate change policy climate_debate discussion 6: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "ba99a63170a3",
              "content": "Climate change policy climate_debate discussion 7: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "fca404931a11",
              "content": "Climate change policy climate_debate discussion 8: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            },
            {
              "name": "Finding: Climate change policy climate_debate dis...",
              "type": "datapoint",
              "id": "33cc52d76205",
              "content": "Climate change policy climate_debate discussion 9: Various perspectives on environmental regulations and economic impacts",
              "timestamp": "2025-09-08T01:02:42.837338",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T01:00:32.034113"
              },
              "children": null
            }
          ]
        }
      ]
    },
    {
      "name": "Search #2025-09-08T01:00:26.635523: Strategic question: Trend...",
      "type": "search",
      "id": "ef6ca49d8ca6",
      "content": "0 with params: {\"query\": \"Strategic question: Trending topics in the United States will show which climate-policy themes are gaining attention among the broader Twitter population and can reveal spikes around legislative events, emissions reports, or climate disasters that influence policy debate.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.836338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Trending topics in the United States will show which climate-policy themes are gaining attention among the broader Twitter population and can reveal spikes around legislative events, emissions reports, or climate disasters that influence policy debate.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.635523"
      },
      "children": [
        {
          "name": "Search #2025-09-08T01:00:26.635523: 0",
          "type": "search",
          "id": "93124fe6ab40",
          "content": "0 with params: {\"endpoint\": \"trends.php\", \"country\": \"UnitedStates\"}",
          "timestamp": "2025-09-08T01:02:42.836338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "trends.php",
              "country": "UnitedStates"
            },
            "search_num": "2025-09-08T01:00:26.635523"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T01:00:26.635523: Strategic question: Greta...",
      "type": "search",
      "id": "4c1d04609388",
      "content": "0 with params: {\"query\": \"Strategic question: Greta Thunberg is a high-profile climate activist whose timeline represents the activist/pressure-group perspective\\u2014useful to capture demands, rhetorical framing, and mobilization language around climate policies.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.836338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Greta Thunberg is a high-profile climate activist whose timeline represents the activist/pressure-group perspective\u2014useful to capture demands, rhetorical framing, and mobilization language around climate policies.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.635523"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T01:00:26.635523: @GretaThunberg",
          "type": "search",
          "id": "512a4ae1843f",
          "content": "0 with params: {\"endpoint\": \"timeline.php\", \"screenname\": \"GretaThunberg\"}",
          "timestamp": "2025-09-08T01:02:42.836338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "timeline.php",
              "screenname": "GretaThunberg"
            },
            "search_num": "2025-09-08T01:00:26.635523"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T01:00:26.635523: Strategic question: Ted C...",
      "type": "search",
      "id": "860eb1e6a8ad",
      "content": "0 with params: {\"query\": \"Strategic question: Ted Cruz is a prominent conservative U.S. politician who frequently tweets on climate-related topics; his timeline helps capture skeptical/conservative policy positions and rhetorical strategies against certain climate policies.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.836338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Ted Cruz is a prominent conservative U.S. politician who frequently tweets on climate-related topics; his timeline helps capture skeptical/conservative policy positions and rhetorical strategies against certain climate policies.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.635523"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T01:00:26.635523: @tedcruz",
          "type": "search",
          "id": "6dee4010be6a",
          "content": "0 with params: {\"endpoint\": \"timeline.php\", \"screenname\": \"tedcruz\"}",
          "timestamp": "2025-09-08T01:02:42.836338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "timeline.php",
              "screenname": "tedcruz"
            },
            "search_num": "2025-09-08T01:00:26.635523"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T01:00:26.635523: Strategic question: The U...",
      "type": "search",
      "id": "458912de5460",
      "content": "0 with params: {\"query\": \"Strategic question: The UNFCCC account represents multilateral diplomatic and scientific-policy perspectives (international climate agreements, finance, national commitments) and gives authoritative policy framing and technical priorities.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.837338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: The UNFCCC account represents multilateral diplomatic and scientific-policy perspectives (international climate agreements, finance, national commitments) and gives authoritative policy framing and technical priorities.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.635523"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T01:00:26.635523: @unfccc",
          "type": "search",
          "id": "5deb5ad8d317",
          "content": "0 with params: {\"endpoint\": \"timeline.php\", \"screenname\": \"unfccc\"}",
          "timestamp": "2025-09-08T01:02:42.837338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "timeline.php",
              "screenname": "unfccc"
            },
            "search_num": "2025-09-08T01:00:26.635523"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T01:00:26.635523: Strategic question: Mappi...",
      "type": "search",
      "id": "3b0ae7215076",
      "content": "0 with params: {\"query\": \"Strategic question: Mapping who Alexandria Ocasio-Cortez follows will help identify allied organizations, think tanks, and influencers linked to progressive policy proposals (e.g., Green New Deal). This network view provides context for coalition messaging and sources of policy expertise.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T01:02:42.837338",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Mapping who Alexandria Ocasio-Cortez follows will help identify allied organizations, think tanks, and influencers linked to progressive policy proposals (e.g., Green New Deal). This network view provides context for coalition messaging and sources of policy expertise.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T01:00:26.635523"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T01:00:26.635523: @AOC",
          "type": "search",
          "id": "59b0670a8757",
          "content": "0 with params: {\"endpoint\": \"following.php\", \"screenname\": \"AOC\"}",
          "timestamp": "2025-09-08T01:02:42.837338",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "following.php",
              "screenname": "AOC"
            },
            "search_num": "2025-09-08T01:00:26.635523"
          },
          "children": null
        }
      ]
    }
  ]
};
        
        // Set up SVG dimensions
        const margin = {top: 40, right: 120, bottom: 40, left: 120};
        const width = 1200 - margin.left - margin.right;
        const height = 800 - margin.top - margin.bottom;
        
        // Create SVG
        const svg = d3.select("#hierarchy-chart")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom);
            
        const g = svg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        // Create hierarchy tree layout
        const treemap = d3.tree().size([width, height]);
        
        // Hierarchy root
        const root = d3.hierarchy(hierarchyData);
        
        // Assign positions
        treemap(root);
        
        // Node colors by type
        const colors = {
            'query': '#9C27B0',
            'search': '#4CAF50', 
            'datapoint': '#2196F3',
            'insight': '#FF9800',
            'root': '#E91E63'
        };
        
        // Tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
        
        // Add links
        const links = g.selectAll(".link")
            .data(root.descendants().slice(1))
            .enter().append("path")
            .attr("class", "link")
            .attr("d", function(d) {
                return `M${d.x},${d.y}C${d.x},${(d.y + d.parent.y) / 2} ${d.parent.x},${(d.y + d.parent.y) / 2} ${d.parent.x},${d.parent.y}`;
            });
        
        // Add nodes
        const nodes = g.selectAll(".node")
            .data(root.descendants())
            .enter().append("g")
            .attr("class", "node")
            .attr("transform", function(d) { 
                return `translate(${d.x},${d.y})`; 
            })
            .on("mouseover", function(event, d) {
                tooltip.transition().duration(200).style("opacity", .9);
                const content = d.data.content || d.data.name || "No content";
                tooltip.html(`<strong>${d.data.name}</strong><br/>${content.substring(0, 200)}${content.length > 200 ? '...' : ''}`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function(d) {
                tooltip.transition().duration(500).style("opacity", 0);
            })
            .on("click", function(event, d) {
                console.log("Node clicked:", d.data);
            });
            
        // Add circles
        nodes.append("circle")
            .attr("r", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? 12 : 8;
            })
            .style("fill", function(d) {
                return colors[d.data.type] || colors['datapoint'];
            });
            
        // Add labels
        nodes.append("text")
            .attr("dy", function(d) {
                return d.children || d._children ? -18 : 18;
            })
            .attr("text-anchor", "middle")
            .style("font-size", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? "14px" : "11px";
            })
            .style("font-weight", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? "bold" : "normal";
            })
            .text(function(d) { 
                const name = d.data.name || d.data.id || "Unknown";
                return name.length > 25 ? name.substring(0, 25) + "..." : name;
            });
            
        // Zoom and pan
        const zoom = d3.zoom()
            .scaleExtent([0.1, 3])
            .on("zoom", function(event) {
                g.attr("transform", event.transform);
            });
            
        svg.call(zoom);
        
        // Initial fit
        const bounds = g.node().getBBox();
        const fullWidth = width;
        const fullHeight = height;
        const widthScale = fullWidth / bounds.width;
        const heightScale = fullHeight / bounds.height;
        const scale = 0.8 * Math.min(widthScale, heightScale);
        const translate = [fullWidth / 2 - scale * bounds.x - scale * bounds.width / 2, fullHeight / 2 - scale * bounds.y - scale * bounds.height / 2];
        
        svg.call(zoom.transform, d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale));
        
        console.log("D3.js Hierarchy visualization loaded with", root.descendants().length, "nodes");
    </script>
</body>
</html>