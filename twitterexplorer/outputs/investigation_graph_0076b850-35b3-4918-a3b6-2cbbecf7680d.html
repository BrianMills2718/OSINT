<!DOCTYPE html>
<html>
<head>
    <title>Investigation Knowledge Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .graph-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        #hierarchy-chart {
            width: 100%;
            height: 800px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
        }
        
        .node {
            cursor: pointer;
        }
        
        .node circle {
            stroke: #fff;
            stroke-width: 2px;
        }
        
        .node text {
            font: 12px sans-serif;
            pointer-events: none;
        }
        
        .link {
            fill: none;
            stroke: #999;
            stroke-width: 2px;
            stroke-opacity: 0.6;
        }
        
        .tooltip {
            position: absolute;
            padding: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 4px;
            font-size: 12px;
            max-width: 300px;
            pointer-events: none;
            z-index: 1000;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #f5f5f5;
            border-radius: 20px;
        }
        .color-box {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        .stats-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .stats-panel h3 {
            margin-top: 0;
            color: #333;
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }
        .stat-value {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .dead-ends {
            margin-top: 15px;
            padding: 10px;
            background: #fff3cd;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }
        .dead-ends h4 {
            margin: 0 0 8px 0;
            color: #856404;
        }
        .dead-end-list {
            margin: 0;
            padding-left: 20px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Investigation Knowledge Graph</h1>
        
        <div class="graph-container">
            <div class="legend">
                <div class="legend-item">
                    <span class="color-box" style="background: #9C27B0;"></span>
                    <span>Initial Query</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #4CAF50;"></span>
                    <span>Search Queries</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #2196F3;"></span>
                    <span>Findings (DataPoints)</span>
                </div>
                <div class="legend-item">
                    <span class="color-box" style="background: #FF9800;"></span>
                    <span>Insights (Patterns)</span>
                </div>
            </div>
            
            <svg id="hierarchy-chart"></svg>
        </div>
        
        
    <div class="stats-panel">
        <h3>Investigation Statistics</h3>
        <div class="stat-grid">
            <div class="stat-item">
                <span class="stat-label">Total Nodes:</span>
                <span class="stat-value">14</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Searches:</span>
                <span class="stat-value">10</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Findings:</span>
                <span class="stat-value">3</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Insights:</span>
                <span class="stat-value">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Connections:</span>
                <span class="stat-value">13</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Graph Density:</span>
                <span class="stat-value">0.071</span>
            </div>
        </div>
        
        <div class="dead-ends">
            <h4>Dead-end Searches (no significant findings):</h4>
            <ul class="dead-end-list">
                <li>Timeline #2025-09-08T02:57:29.136923: @Southcom</li>
<li>Timeline #2025-09-08T02:57:29.136923: @DeptofDefense</li>
<li>Timeline #2025-09-08T02:57:29.136923: @NicolasMaduro</li>
            </ul>
        </div>
    </div>
    </div>

    <script>
        // Hierarchy data from Python
        const hierarchyData = {
  "name": "Query: Trump sent military to Venezue...",
  "type": "query",
  "id": "3970d8a2cbb7",
  "content": "Trump sent military to Venezuela test analysis",
  "timestamp": "2025-09-08T02:57:04.451707",
  "metadata": {
    "original_query": "Trump sent military to Venezuela test analysis"
  },
  "children": [
    {
      "name": "Search #2025-09-08T02:57:29.136923: Strategic question: Locat...",
      "type": "search",
      "id": "e292a6b91c70",
      "content": "0 with params: {\"query\": \"Strategic question: Locate recent tweets that explicitly claim Trump sent military forces to Venezuela (covering common phrasings). 'Latest' will surface ongoing tweets and new posts that may show the claim's origin or current spread.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T02:59:58.765339",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Locate recent tweets that explicitly claim Trump sent military forces to Venezuela (covering common phrasings). 'Latest' will surface ongoing tweets and new posts that may show the claim's origin or current spread.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T02:57:29.136923"
      },
      "children": [
        {
          "name": "Search #2025-09-08T02:57:29.136923: \"Trump sent military to V...",
          "type": "search",
          "id": "ae9678179e2d",
          "content": "0 with params: {\"endpoint\": \"search.php\", \"query\": \"\\\"Trump sent military to Venezuela\\\" OR \\\"sent troops to Venezuela\\\" OR \\\"sent military to Venezuela\\\"\", \"search_type\": \"Latest\"}",
          "timestamp": "2025-09-08T02:59:58.765339",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "search.php",
              "query": "\"Trump sent military to Venezuela\" OR \"sent troops to Venezuela\" OR \"sent military to Venezuela\"",
              "search_type": "Latest"
            },
            "search_num": "2025-09-08T02:57:29.136923"
          },
          "children": [
            {
              "name": "Finding: The real reason Trump has sent troops to...",
              "type": "datapoint",
              "id": "2c6fcce03489",
              "content": "The real reason Trump has sent troops to Venezuela https://t.co/9j7tIO9KWA via @YouTube",
              "timestamp": "2025-09-08T02:59:58.765339",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T02:58:14.174241"
              },
              "children": null
            },
            {
              "name": "Finding: Interesting observation as to why Trump ...",
              "type": "datapoint",
              "id": "647a4740bcc4",
              "content": "Interesting observation as to why Trump sent troops to Venezuela \nSeptember 3, 2025\n\nhttps://t.co/ktonF1bos6",
              "timestamp": "2025-09-08T02:59:58.765339",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T02:58:14.174241"
              },
              "children": null
            }
          ]
        }
      ]
    },
    {
      "name": "Search #2025-09-08T02:57:29.136923: Strategic question: Check...",
      "type": "search",
      "id": "e683d103ec45",
      "content": "0 with params: {\"query\": \"Strategic question: Check whether Donald Trump himself posted anything about Venezuela or deploying troops. Using 'Top' surfaces the most prominent/retweeted statements from his account (if present).\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T02:59:58.765339",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Check whether Donald Trump himself posted anything about Venezuela or deploying troops. Using 'Top' surfaces the most prominent/retweeted statements from his account (if present).",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T02:57:29.136923"
      },
      "children": [
        {
          "name": "Search #2025-09-08T02:57:29.136923: from:realDonaldTrump Vene...",
          "type": "search",
          "id": "1256d9fa52da",
          "content": "0 with params: {\"endpoint\": \"search.php\", \"query\": \"from:realDonaldTrump Venezuela OR Venezuela troop OR \\\"troops to Venezuela\\\"\", \"search_type\": \"Top\"}",
          "timestamp": "2025-09-08T02:59:58.765339",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "search.php",
              "query": "from:realDonaldTrump Venezuela OR Venezuela troop OR \"troops to Venezuela\"",
              "search_type": "Top"
            },
            "search_num": "2025-09-08T02:57:29.136923"
          },
          "children": [
            {
              "name": "Finding: If Cuban Troops and Militia do not immed...",
              "type": "datapoint",
              "id": "89fdfef7b589",
              "content": "If Cuban Troops and Militia do not immediately CEASE military and other operations for the purpose of causing death and destruction to the Constitution of Venezuela, a full and complete....",
              "timestamp": "2025-09-08T02:59:58.765339",
              "metadata": {
                "source": "search.php",
                "relevance": "2025-09-08T02:58:45.013769"
              },
              "children": null
            }
          ]
        }
      ]
    },
    {
      "name": "Search #2025-09-08T02:57:29.136923: Strategic question: US So...",
      "type": "search",
      "id": "cc84305bade3",
      "content": "0 with params: {\"query\": \"Strategic question: US Southern Command (Southcom) would be the most relevant operational account to confirm any troop movements or statements about deployments to Venezuela. Reviewing its timeline checks for any official announcements, clarifications, or denials.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T02:59:58.765339",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: US Southern Command (Southcom) would be the most relevant operational account to confirm any troop movements or statements about deployments to Venezuela. Reviewing its timeline checks for any official announcements, clarifications, or denials.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T02:57:29.136923"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T02:57:29.136923: @Southcom",
          "type": "search",
          "id": "aa0d0fa72e23",
          "content": "0 with params: {\"endpoint\": \"timeline.php\", \"screenname\": \"Southcom\"}",
          "timestamp": "2025-09-08T02:59:58.765339",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "timeline.php",
              "screenname": "Southcom"
            },
            "search_num": "2025-09-08T02:57:29.136923"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T02:57:29.136923: Strategic question: The D...",
      "type": "search",
      "id": "1d75d99fb724",
      "content": "0 with params: {\"query\": \"Strategic question: The Department of Defense would likely release statements if US forces were sent. Examining its timeline helps verify or refute the claim from an authoritative source and identify timing/context if an operation was announced.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T02:59:58.765339",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: The Department of Defense would likely release statements if US forces were sent. Examining its timeline helps verify or refute the claim from an authoritative source and identify timing/context if an operation was announced.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T02:57:29.136923"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T02:57:29.136923: @DeptofDefense",
          "type": "search",
          "id": "702dbcefbfe2",
          "content": "0 with params: {\"endpoint\": \"timeline.php\", \"screenname\": \"DeptofDefense\"}",
          "timestamp": "2025-09-08T02:59:58.765339",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "timeline.php",
              "screenname": "DeptofDefense"
            },
            "search_num": "2025-09-08T02:57:29.136923"
          },
          "children": null
        }
      ]
    },
    {
      "name": "Search #2025-09-08T02:57:29.136923: Strategic question: Check...",
      "type": "search",
      "id": "1799e855570f",
      "content": "0 with params: {\"query\": \"Strategic question: Check the Venezuelan president's official account for claims that US forces arrived, threats, or requests for assistance. If Maduro or other Venezuelan officials claimed US forces were present, that will be important context and a lead to trace sources.\", \"type\": \"investigation_question\"}",
      "timestamp": "2025-09-08T02:59:58.765339",
      "metadata": {
        "endpoint": 0,
        "params": {
          "query": "Strategic question: Check the Venezuelan president's official account for claims that US forces arrived, threats, or requests for assistance. If Maduro or other Venezuelan officials claimed US forces were present, that will be important context and a lead to trace sources.",
          "type": "investigation_question"
        },
        "search_num": "2025-09-08T02:57:29.136923"
      },
      "children": [
        {
          "name": "Timeline #2025-09-08T02:57:29.136923: @NicolasMaduro",
          "type": "search",
          "id": "520ac5fa23e7",
          "content": "0 with params: {\"endpoint\": \"screenname.php\", \"screenname\": \"NicolasMaduro\"}",
          "timestamp": "2025-09-08T02:59:58.765339",
          "metadata": {
            "endpoint": 0,
            "params": {
              "endpoint": "screenname.php",
              "screenname": "NicolasMaduro"
            },
            "search_num": "2025-09-08T02:57:29.136923"
          },
          "children": null
        }
      ]
    }
  ]
};
        
        // Set up SVG dimensions
        const margin = {top: 40, right: 120, bottom: 40, left: 120};
        const width = 1200 - margin.left - margin.right;
        const height = 800 - margin.top - margin.bottom;
        
        // Create SVG
        const svg = d3.select("#hierarchy-chart")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom);
            
        const g = svg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        // Create hierarchy tree layout
        const treemap = d3.tree().size([width, height]);
        
        // Hierarchy root
        const root = d3.hierarchy(hierarchyData);
        
        // Assign positions
        treemap(root);
        
        // Node colors by type
        const colors = {
            'query': '#9C27B0',
            'search': '#4CAF50', 
            'datapoint': '#2196F3',
            'insight': '#FF9800',
            'root': '#E91E63'
        };
        
        // Tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
        
        // Add links
        const links = g.selectAll(".link")
            .data(root.descendants().slice(1))
            .enter().append("path")
            .attr("class", "link")
            .attr("d", function(d) {
                return `M${d.x},${d.y}C${d.x},${(d.y + d.parent.y) / 2} ${d.parent.x},${(d.y + d.parent.y) / 2} ${d.parent.x},${d.parent.y}`;
            });
        
        // Add nodes
        const nodes = g.selectAll(".node")
            .data(root.descendants())
            .enter().append("g")
            .attr("class", "node")
            .attr("transform", function(d) { 
                return `translate(${d.x},${d.y})`; 
            })
            .on("mouseover", function(event, d) {
                tooltip.transition().duration(200).style("opacity", .9);
                const content = d.data.content || d.data.name || "No content";
                tooltip.html(`<strong>${d.data.name}</strong><br/>${content.substring(0, 200)}${content.length > 200 ? '...' : ''}`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function(d) {
                tooltip.transition().duration(500).style("opacity", 0);
            })
            .on("click", function(event, d) {
                console.log("Node clicked:", d.data);
            });
            
        // Add circles
        nodes.append("circle")
            .attr("r", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? 12 : 8;
            })
            .style("fill", function(d) {
                return colors[d.data.type] || colors['datapoint'];
            });
            
        // Add labels
        nodes.append("text")
            .attr("dy", function(d) {
                return d.children || d._children ? -18 : 18;
            })
            .attr("text-anchor", "middle")
            .style("font-size", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? "14px" : "11px";
            })
            .style("font-weight", function(d) {
                return d.data.type === 'query' || d.data.type === 'root' ? "bold" : "normal";
            })
            .text(function(d) { 
                const name = d.data.name || d.data.id || "Unknown";
                return name.length > 25 ? name.substring(0, 25) + "..." : name;
            });
            
        // Zoom and pan
        const zoom = d3.zoom()
            .scaleExtent([0.1, 3])
            .on("zoom", function(event) {
                g.attr("transform", event.transform);
            });
            
        svg.call(zoom);
        
        // Initial fit
        const bounds = g.node().getBBox();
        const fullWidth = width;
        const fullHeight = height;
        const widthScale = fullWidth / bounds.width;
        const heightScale = fullHeight / bounds.height;
        const scale = 0.8 * Math.min(widthScale, heightScale);
        const translate = [fullWidth / 2 - scale * bounds.x - scale * bounds.width / 2, fullHeight / 2 - scale * bounds.y - scale * bounds.height / 2];
        
        svg.call(zoom.transform, d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale));
        
        console.log("D3.js Hierarchy visualization loaded with", root.descendants().length, "nodes");
    </script>
</body>
</html>